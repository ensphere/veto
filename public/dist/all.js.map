{"version":3,"sources":["bootstrap.js","routes.js","filter.js","veto.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"all.js","sourcesContent":["\n$.ajaxSetup({\n    headers: {\n        'X-CSRF-TOKEN': $( 'meta[name=\"csrf-token\"]' ).attr( 'content' )\n    }\n});\n","\n/**\n * Laravel Routes\n * @type {{route}}\n */\nvar LaravelRoutes = new function() {\n\n    var routes = null;\n\n    /**\n     * Load JSON\n     * @param path\n     * @param success\n     * @param error\n     */\n    var loadJSON = function( path, success, error )\n    {\n        var xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = function()\n        {\n            if (xhr.readyState === XMLHttpRequest.DONE) {\n                if (xhr.status === 200) {\n                    if (success)\n                        success(JSON.parse(xhr.responseText));\n                } else {\n                    if (error)\n                        error(xhr);\n                }\n            }\n        };\n        xhr.open( \"GET\", path, false );\n        xhr.send();\n    };\n\n    /**\n     * Get Router\n     * @param name\n     * @param callback\n     * @returns {*}\n     */\n    var getRouter = function( name, callback )\n    {\n        if( typeof routes[ name ] !== 'undefined' ) {\n            return callback( routes[ name ] );\n        } else {\n            console.log( 'route [' + name + '] does not exist' );\n        }\n    };\n\n    /**\n     * Generate Route Uri\n     * @param router\n     * @param _parameters\n     * @returns {string}\n     */\n    var generateRouteUri = function( router, _parameters )\n    {\n        var parameters = _parameters || [];\n        router.uri = router.path;\n        router.uri_variables.forEach( function( variable ) {\n            var replaceWith = parameters.shift() || null;\n            var rExpression = new RegExp( \"{\" + variable + \"\\\\??}\", \"g\" );\n            router.uri = router.uri.replace( rExpression, replaceWith );\n        });\n        return '/' + router.uri;\n    };\n\n    loadJSON( window.routesUrl ? window.routesUrl : '/routes.json', function( data ) {\n        routes = data;\n    });\n\n    return {\n        route : function( name, parameters )\n        {\n            return getRouter( name, function ( router ) {\n                return generateRouteUri( router, parameters );\n            });\n        }\n    }\n\n};\n","\n\n$.fn.ajaxFilter = function( _options )\n{\n\n    var _ajaxFilter = function( elm, options )\n    {\n\n        var handleOnSelectedItem = function( item, e, model )\n        {\n            $.post( options.addItemUrl, { relatedId: model[ options.itemIndex ] });\n            addTableBodyRow( model );\n        };\n\n        options = $.extend( {\n\n            sortable: false,\n            extraQueryParameters: {},\n            filterUrl: '',\n            currentListUrl: '',\n            removeItemUrl: '',\n            addItemUrl: '',\n            sortUrl: '',\n            itemIndex: 'id',\n            label: 'Start to type to filter:',\n            noResultsText: 'No results',\n            tableColumns: [ 'id', 'name' ],\n            onSelectedItem : handleOnSelectedItem,\n            displayRow: function( item ) {\n                return '#' + item.id + ' - ' + item.name;\n            }\n\n        }, options );\n\n        var items = {};\n\n        var uuidv4 = function()\n        {\n            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n                var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n                return 'ID-' + v.toString(16);\n            });\n        };\n\n        var searchTemplate = '' +\n            '<div class=\"field c-ajax-filter\">' +\n            '<label class=\"c-ajax-filter__label\">' + options.label + '</label>' +\n            '<input type=\"text\" class=\"form-control c-ajax-filter__input\" />' +\n            '</div>';\n\n        var resultsTemplate = '' +\n            '<div class=\"c-ajax-filter__results\"></div>';\n\n        var api = {\n\n            search: null,\n            searchBox: null,\n            results: null,\n            table:{\n                head: null,\n                body: null\n            }\n\n        };\n\n        var xhr;\n\n        var populateResults = function( response )\n        {\n            api.results.html('');\n            for( var i in response ) {\n                var item = response[i];\n                var uid = uuidv4();\n                var text = options.displayRow( item );\n                var resultItem = $( '<div />' ).html( text ).addClass( 'c-ajax-filter__results__item' );\n                items[uid] = item;\n                api.results.prepend( resultItem );\n                resultItemEvents( resultItem );\n                resultItem[0].uid = uid;\n            }\n            api.results.width( api.searchBox.outerWidth() ).show();\n        };\n\n        var closeAndClearSearchBox = function()\n        {\n            api.searchBox.val( '' );\n            api.results.html( '' ).hide();\n        };\n\n        var resultItemEvents = function( elm )\n        {\n            elm.on( 'mouseenter', onItemMouseEnterHandler );\n            elm.on( 'mouseleave', onItemMouseLeaveHandler );\n            elm.on( 'click', function(e) {\n                options.onSelectedItem( $(this), e, items[ $( this )[0].uid ] );\n                $(this).hide();\n            });\n        };\n\n        var onItemMouseEnterHandler = function(e)\n        {\n            $(this).addClass( 'c-ajax-filter__results__item--hover' );\n        };\n\n        var onItemMouseLeaveHandler = function(e)\n        {\n            $(this).removeClass( 'c-ajax-filter__results__item--hover' );\n        };\n\n        var onDocumentClickHandler = function(e)\n        {\n            var elm = $( e.target );\n            if( ! elm.parents( '.c-ajax-filter:eq(0)' ).length ) {\n                closeAndClearSearchBox();\n            }\n        };\n\n        var onSearchBoxKeyUpHandler = function(e)\n        {\n            e.preventDefault();\n            if( xhr && xhr.readystate != 4 ) xhr.abort();\n            xhr = $.getJSON( options.filterUrl, $.extend({ query: $(this).val() }, options.extraQueryParameters ), populateResults );\n        };\n\n        var bindEvents = function()\n        {\n            api.searchBox.on( 'keyup', onSearchBoxKeyUpHandler );\n            $(document).on( 'click', onDocumentClickHandler );\n        };\n\n        var onClickRemoveItemHandler = function(e)\n        {\n            var payload = parseInt( $(this).attr('data-payload') );\n            var row = $(this).parents('tr:eq(0)');\n            $.post( options.removeItemUrl, $.extend({ relatedId: payload }, options.extraQueryParameters ), function(){\n                row.remove();\n                addNoResultsIfEmpty();\n            });\n        };\n\n        var sortableHandle = function()\n        {\n            if( ! options.sortable ) return '';\n            return '<a class=\"btn btn-info btn-sm handle\"><i class=\"fa fa-arrows\"></i></a>';\n        };\n\n        var addTableBodyRow = function( model )\n        {\n            var row = $('<tr />').attr( 'data-row-id', model[options.itemIndex] );\n            options.tableColumns.forEach( function( column ) {\n                $('<td />').text( model[column] ).appendTo( row );\n            });\n            $('<td />').html( '' +\n                '<div class=\"btn-group\">' +\n                '<a class=\"btn btn-danger btn-sm js-delete\" data-payload=\"' + model[options.itemIndex] + '\"><i class=\"fa fa-trash\"></i></a>' +\n                sortableHandle() +\n                '</div>'\n            ).appendTo( row );\n            row.appendTo( api.table.body );\n            $( '[data-payload]', row ).on( 'click', onClickRemoveItemHandler );\n        };\n\n        var addNoResultsIfEmpty = function()\n        {\n            if( ! $( 'tr', api.table.body ).length ) {\n                $('<tr />').attr( 'data-for', 'no-results' ).append( $( '<td />' ).attr( 'colspan', 20 ).text( options.noResultsText ) ).appendTo( api.table.body );\n            }\n        };\n\n        var removeNoResultsIfNotEmpty = function()\n        {\n            if( $( 'tr', api.table.body ).length > 1 ) {\n                $( '[data-for=\"no-results\"]', api.table.body ).remove();\n            }\n        };\n\n        var getCurrentList = function()\n        {\n            $.getJSON( options.currentListUrl, options.extraQueryParameters, function( response ) {\n                for( var i in response ) {\n                    addTableBodyRow( response[i] );\n                }\n                addNoResultsIfEmpty();\n\n            });\n        };\n\n        var createTable = function()\n        {\n            var table = $('<table />').addClass( 'ui table' );\n            var head = $( '<thead />');\n            var body = $( '<tbody />');\n            table.append( head ).append( body );\n            table.insertAfter( elm );\n            api.table.head = head;\n            api.table.body = body;\n\n            var row = $('<tr />');\n            options.tableColumns.forEach( function( column ) {\n                $('<th />').text( column ).appendTo( row );\n            });\n            $('<th width=\"95\" />').text( 'actions' ).appendTo( row );\n            row.appendTo( api.table.head );\n            getCurrentList();\n\n        };\n\n        var onSortEndHandler = function()\n        {\n            var data = [];\n            $( 'tr', api.table.body ).each( function( index ) {\n                data.push( $(this).attr( 'data-row-id' ) );\n            });\n            $.post( options.sortUrl, { sort: data } );\n        };\n\n        var init = function()\n        {\n            var search = $( searchTemplate ).appendTo( elm );\n            var results = $( resultsTemplate ).appendTo( search );\n            api.search = search;\n            api.searchBox = $( '.c-ajax-filter__input', api.search );\n            api.results = results;\n            createTable();\n            bindEvents();\n            if( options.sortable ) {\n                api.sortable = Sortable.create( api.table.body.get(0), {\n                    handle: '.handle',\n                    onUpdate: onSortEndHandler\n                });\n            }\n        };\n\n        init();\n\n        return api;\n\n    };\n\n    return $(this).each( function() {\n\n        $(this)[0].ajaxFilter = new _ajaxFilter( $(this), _options );\n\n    });\n\n};\n","\n/**\n * Ensphere Container\n */\n$.fn.ensphere = new function() {\n\n    /**\n     * Veto\n     */\n    this.veto = new function() {\n\n        var modal;\n\n        var wysiwygSelectors = [];\n\n        var parseNotifications = function()\n        {\n            $('[type=\"ensphere/notification\"]').each(function(){\n                var options = JSON.parse( $(this).html() );\n                new PNotify( options );\n            });\n        };\n\n        var removePageLoader = function()\n        {\n            var loader = $('#loader');\n            if( loader.length ) {\n                loader.fadeOut( 200, function(){\n                    $(this).remove();\n                });\n            }\n        };\n\n        var openMenuWhenActiveUrlParentIsPresent = function()\n        {\n            $( '> a', $('#sidebar-menu .active-url-parent:eq(0)').parents('#sidebar-menu .has-children:eq(0)') ).trigger( 'click' );\n        };\n\n        var forceModalCloseBox = function()\n        {\n            $(document).on( 'mousedown', '.ui-dialog-titlebar-close', function(){\n                $('textarea').redactor('modal.close');\n            });\n        };\n\n        var onDocumentReady = function()\n        {\n            parseNotifications();\n            CharacterLimiter();\n            forceModalCloseBox();\n\n            $.fn.ensphere.veto.wysiwyg( '.veto-wysiwyg' );\n            //openMenuWhenActiveUrlParentIsPresent();\n        };\n\n        var onWindowLoad = function()\n        {\n            removePageLoader();\n        };\n\n        /**\n         *\n         * @param errors\n         * @param modal\n         */\n        var modalError = function( errors, modal )\n        {\n            var wrapper = $('<div class=\"alert alert-danger\" role=\"alert\"><div class=\"header\">There was some errors with your submission</div><ul class=\"list\"></ul></div>');\n            errors.forEach(function(error){\n                $('<li />').text(error).appendTo( $( 'ul', wrapper ) );\n            });\n            $('[data-for=\"error-wrapper\"]', modal).html('').append(wrapper);\n            modal.semanticUiModal('refresh');\n        };\n\n        /**\n         *\n         * @param obj\n         */\n        var attachWYSIWYG = function( obj )\n        {\n            if( obj.data( 'wysiwyg' ) ) return false;\n            $.Redactor.prototype.scriptbuttons = function()\n            {\n                return {\n                    init: function()\n                    {\n                        var cite = this.button.add('cite', 'Cite');\n\n                        this.button.addCallback(cite, this.scriptbuttons.formatCite);\n\n                        // Set icons\n                        this.button.setAwesome('cite','fa-quote-right');\n                    },\n                    formatCite: function()\n                    {\n                        this.inline.format('cite');\n                    }\n                };\n            };\n            obj.data( 'wysiwyg', true );\n            obj.redactor({\n                minHeight : 300,\n                toolbarFixed : true,\n                cleanStyleOnEnter : true,\n                buttons: ['html', 'formatting', 'bold', 'italic', 'deleted', 'unorderedlist', 'orderedlist',\n                  'outdent', 'indent', 'link', 'alignment', 'horizontalrule'],\n                deniedTags : ['html', 'head', 'link', 'body', 'meta', 'script', 'style', 'applet' ],\n                plugins : [ 'mediaManager', 'scriptbuttons', 'properties' ]\n            });\n        };\n\n        var checkForNewWysiwygInstances = function()\n        {\n            setTimeout( function(){\n                wysiwygSelectors.forEach( function(selector) {\n                    $( selector + ':visible' ).each( function(){\n                        if( ! $(this).data( 'wysiwyg' ) ) {\n                            attachWYSIWYG( $(this) );\n                        }\n                    });\n                });\n            }, 200 );\n\n        };\n\n        var CharacterLimiter = function()\n        {\n\n            var app = function( self )\n            {\n\n                var elm = $(self);\n\n                var startElm = elm.clone();\n\n                var counting = null;\n\n                var input = null;\n\n                var placeholder = null;\n\n                var maxChars = parseInt( elm.attr( 'data-character-limit' ) );\n\n                /**\n                 *\n                 * @returns {jQuery|HTMLElement}\n                 */\n                var buildPlaceholder = function()\n                {\n                    var template = '<div class=\"c-character-limiter\"><div data-for=\"input\" class=\"c-character-limiter__input\"></div><div class=\"count\"><span class=\"c-character-limiter__counting\" data-for=\"counting\">0</span></div></div>';\n                    return $( template );\n                };\n\n                var destroy = function()\n                {\n\n                };\n\n                var setCharCount = function()\n                {\n                    var remaining = maxChars - elm.val().length;\n                    counting.text(remaining).removeClass( 'danger warning' );\n                    if( remaining <= 0 ) {\n                        counting.addClass( 'danger' );\n                    } else if( remaining <= 10 ) {\n                        counting.addClass( 'warning' );\n                    }\n                };\n\n                var start = function()\n                {\n                    placeholder = buildPlaceholder();\n                    placeholder.insertBefore( elm );\n                    elm.appendTo( $( '[data-for=\"input\"]', placeholder ) );\n                    input = $( '[data-for=\"input\"]', placeholder );\n                    counting = $( '[data-for=\"counting\"]', placeholder );\n\n                    elm.on( 'keyup', setCharCount ).trigger( 'keyup' );\n                };\n\n                var api = {\n                    destroy: destroy\n                };\n\n                start();\n\n                return api;\n            };\n\n            $('[data-character-limit]').each( function () {\n                $(this).data( 'character-limit', new app( this ) );\n            });\n\n        };\n\n        $(document).bind( 'click.veto', checkForNewWysiwygInstances );\n\n        $( \".js-delete\" ).bind( \"click\", function(e) {\n            var button = $(this);\n            e.preventDefault();\n            swal({\n                title: \"Are you sure?\",\n                text: \"This action cannot be reversed\",\n                type: \"warning\",\n                showCancelButton: true,\n                confirmButtonClass: 'btn-danger',\n                confirmButtonText: 'Yes, delete it!',\n                cancelButtonText: \"No, cancel please!\",\n                closeOnConfirm: false,\n                closeOnCancel: false\n            }, function( isConfirm ) {\n                if ( isConfirm ) {\n                    window.location = button.attr('href');\n                } else {\n                    swal.close();\n                }\n            });\n        });\n\n        /**\n         * Refreshes the modal\n         */\n        this.refreshModal = function()\n        {\n            modal.semanticUiModal( 'refresh' );\n        };\n\n        /**\n         *\n         * @param text\n         * @returns {string}\n         */\n        this.slugify = function( text )\n        {\n            return text.toString().toLowerCase()\n                .replace( /\\s+/g, '-' )           // Replace spaces with -\n                .replace( /[^\\w\\-]+/g, '' )       // Remove all non-word chars\n                .replace( /\\-\\-+/g, '-' )         // Replace multiple - with single -\n                .replace( /^-+/, '' )             // Trim - from start of text\n                .replace( /-+$/, '' );            // Trim - from end of text\n        };\n\n        /**\n         *\n         * @param selector\n         * @param context\n         */\n        this.wysiwyg = function( selector, context )\n        {\n            wysiwygSelectors.push( selector );\n            context = context || $(document);\n            attachWYSIWYG( $( selector, context ) );\n        };\n\n        /**\n         *\n         * @param selector\n         * @param el\n         * @returns {*}\n         */\n        this.select = function( selector, el ) {\n            if ( ! el ) { el = document; }\n            return Array.prototype.slice.call( el.querySelectorAll( selector ) );\n        };\n\n        /**\n         *\n         * @param node\n         * @param _callbacks\n         */\n        this.singleSelect = function( selector, el ) {\n            if ( ! el ) { el = document; }\n            return el.querySelector( selector );\n        };\n\n        /**\n         *\n         * @param elm\n         * @param callback\n         */\n        this.clickEvent = function( elm, callback )\n        {\n            elm.removeEventListener( \"click\", callback );\n            elm.addEventListener( \"click\", callback );\n        };\n\n        /**\n         *\n         * @param node\n         * @param _callbacks\n         */\n        this.keyUpEvent = function( elm, callback )\n        {\n            if( elm ) {\n                elm.removeEventListener( \"keyup\", callback );\n                elm.addEventListener( \"keyup\", callback );\n            }\n        };\n\n        /**\n         *\n         * @param node\n         * @param _callbacks\n         */\n        this.focusEvent = function( elm, callback )\n        {\n            if( elm ) {\n                elm.removeEventListener( \"focus\", callback );\n                elm.addEventListener( \"focus\", callback );\n            }\n        };\n\n        /**\n         *\n         * @param node\n         * @param _callbacks\n         */\n        this.modalEdit = function( node, _callbacks )\n        {\n            var form = $(node).parents( 'form:eq(0)' );\n            _callbacks = _callbacks || {};\n            var callbacks = $.extend({\n                onVisible   : function(){},\n                onComplete  : function(){},\n                onError     : function(){},\n                onSave      : function(){},\n                onResponse  : function(){},\n                closeModal  : true\n            }, _callbacks);\n            var attributes = $.fn.ensphere.veto.getAttributes( node );\n            $(node).blur();\n            $.get( attributes.href, function( response ) {\n                callbacks.onResponse( response, attributes );\n                if( typeof $( response )[0].ownerDocument !== 'undefined' ) {\n                    $.fn.ensphere.veto.modalResponse( response, attributes, callbacks );\n                }\n            });\n        };\n\n        /**\n         *\n         * @param node\n         * @returns {{}}\n         */\n        this.getAttributes = function( node )\n        {\n            var attributes = {};\n            for( var i in node.attributes ) {\n                if( node.attributes.hasOwnProperty( i ) ) {\n                    attributes[node.attributes[i].name] = node.attributes[i].nodeValue;\n                }\n            }\n            return attributes;\n        };\n\n\n        this.route  = function( name, parameters )\n        {\n            return LaravelRoutes.route( name, parameters );\n        };\n\n        /**\n         *\n         * @param response\n         * @param attributes\n         * @param callbacks\n         */\n        this.modalResponse = function( response, attributes, callbacks ){\n            if( typeof modal !== 'undefined' ) {\n                modal.semanticUiModal('close');\n            }\n            modal = $(response);\n            modal.semanticUiModal({\n                observeChanges : false,\n                onVisible : function() {\n                    var modalObj = $(this);\n                    var buttons = $('.ui.button, .btn.btn-success', modalObj);\n                    var _token = $('[name=\"_token\"]', modalObj).val();\n                    var form = $('form', modalObj);\n\n                    buttons.each(function(){\n                        $(this).click( function(e){\n                            var button = $(this);\n                            e.preventDefault();\n                            if( form.length && button[0].tagName.toLowerCase() === 'button' ) {\n                                var action = form.attr('action');\n                            } else {\n                                var action = $(this).attr('href');\n                            }\n                            callbacks.onSave( $(this), modalObj );\n                            var ajaxOptions = {\n                                type: 'GET',\n                                async: false,\n                                url: action,\n                                data : $('input, select, textarea', form).not('[name=\"_token\"]').serialize(),\n                                success: function( response ){\n                                    if( $(response)[0].id ) {\n                                        callbacks.onComplete( response, attributes, modal );\n                                    } else {\n                                        $.fn.ensphere.veto.modalResponse( response, attributes, callbacks );\n                                    }\n                                },\n                                error: function ( xhr, textstatus ) {\n                                    switch( xhr.status ) {\n                                        case 422 :\n                                            var errors = [];\n                                            /** Validation error */\n                                            var response = JSON.parse( xhr.responseText );\n                                            for( var i in response.errors ) {\n                                                errors.push( response.errors[i][0] );\n                                            }\n                                            modalError( errors, modal );\n                                            break;\n                                        case 403 :\n                                            modalError( [\"Request middleware denied this action\"], modal );\n                                            break;\n                                        default :\n                                            modalError( ['Unknown error has occurred: [\"' + xhr.status + '\",\"' + textstatus + '\"]'], modal );\n                                            break;\n                                    }\n                                    callbacks.onError( modalObj, xhr );\n                                }\n                            };\n                            if( form.length ) {\n                                ajaxOptions.headers = { 'X-CSRF-TOKEN' : _token };\n                                ajaxOptions.type = 'POST';\n                            }\n                            $.ajax(ajaxOptions);\n                        });\n                    });\n                    callbacks.onVisible( modalObj );\n                }\n            }).semanticUiModal('show');\n        };\n\n        $(document).ready(onDocumentReady);\n        $(window).load(onWindowLoad);\n\n\n    };\n};\n"]}